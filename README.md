# Rotating_Shallow_Water_Verification_Suite

[![DOI](https://zenodo.org/badge/DOI/10.5281/zenodo.7425628.svg)](https://doi.org/10.5281/zenodo.7425628)

The Rotating_Shallow_Water_Verification_Suite (RSWVS) repository contains code in object-oriented Python for solving the rotating shallow water system of equations using

    a. two types of spatial discretizations:
        i.  a TRiSK-based mimetic finite volume method used in MPAS-Ocean;
        ii. a discontinuous Galerkin Spectral Element Method (DGSEM); and
    b. a variety of time-stepping methods.

The repository also includes a verification suite of shallow water test cases for the barotropic solver of ocean models. Each of these test cases verifies the implementation of a subset of terms in the prognostic momentum and continuity equations e.g. the linear pressure gradient term, the linear constant or variable-coefficient Coriolis and bathymetry terms, and the non-linear advection terms. Convergence studies are conducted with refinement in 

    a. both space and time (for test cases equipped with exact solutions);
    b. only in space; and 
    c. only in time.

RSWVS can also be used as a platform for developing and testing novel time-stepping methods to advance the barotropic equations of an ocean model. It is organized into the following directories: 

    |-- meshes
    |   |-- MPAS_Ocean_Shallow_Meshes
    |-- src
    |   |-- MPAS_Ocean_Shallow_Water
    |   |-- DGSEM_Rotating_Shallow_Water
    |-- tests
    |   |-- MPAS_Ocean_Shallow_Water_Tests
    |   |-- DGSEM_Rotating_Shallow_Water_Tests
    |-- tutorials
    |   |-- MPAS_Ocean_Shallow_Water_Tutorials
    |   |-- DGSEM_Rotating_Shallow_Water_Tutorials
    |-- output
    |   |-- MPAS_Ocean_Shallow_Water_Output
    |   |-- DGSEM_Rotating_Shallow_Water_Output
    |-- CITATION.cff
    |-- LICENSE
    |-- README.md

The src directory contains the source code and the visualization code, the tests directory contains code for testing the functions in the scripts of the src directory. The scripts in the tutorials directory are exact replicas of the ones in the tests directory but in Jupyter Notebook format. It is up to the user to choose between a specific Python script in the tests directory and its equivalent Jupyter Notebook in the tutorials directory to test one or more functions in the corresponding script in the src directory. The reason the Jupyter Notebooks are included is because it is sometimes convenient to run only a few cells of the Jupyter Notebook, and check out any error message or the output of print statements right below the cells as opposed to all over the terminal. As shown above, each of the src, tests, tutorials, and output directories contains two subdirectories corresponding to two types of spatial discretizations: the TRiSK-based mimetic finite volume method and DGSEM. The MPAS_Ocean_Shallow_Water_Meshes subdirectory within the meshes directory should contain the planar hexagonal MPAS-Ocean mesh files for simulating the numerical solutions and conducting convergence studies. These mesh files being of considerable size, are not included within the Github repository. But the entire MPAS_Ocean_Shallow_Water_Meshes subdirectory can be downloaded from [here](https://zenodo.org/record/7419817). The output generated by the two types of spatial discretizations will be placed in the respective subdirectories within the output directory. Interested modelers can download some output files and plots from [here](https://zenodo.org/record/7420073). These include plots of the exact solution and the numerical error of the various test cases at specific instants of time; and convergence plots of the L<sup>2</sup> error norm with respect to the exact solution for refinement in both space and time, and convergence plots of the L<sup>2</sup> norm of the difference in the numerical solution for refinement only in space and only in time.